body {
    margin: 0;
    background: #0d0d0f;
    color: #eee;
    font-family: Arial, sans-serif;
    display: flex;
    flex-direction: column;
    height: 100vh;
    overflow: hidden; 
}

/* Стили для полос прокрутки (Chrome, Safari, Opera) */
body::-webkit-scrollbar, #workspace::-webkit-scrollbar, #mindmap-area::-webkit-scrollbar { width: 10px; height: 10px; }
body::-webkit-scrollbar-track, #workspace::-webkit-scrollbar-track, #mindmap-area::-webkit-scrollbar-track { background: #111; }
body::-webkit-scrollbar-thumb, #workspace::-webkit-scrollbar-thumb, #mindmap-area::-webkit-scrollbar-thumb { background: #444; border-radius: 5px; }
body::-webkit-scrollbar-thumb:hover, #workspace::-webkit-scrollbar-thumb:hover, #mindmap-area::-webkit-scrollbar-thumb:hover { background: #555; }

/* Предотвращает выделение текста при долгом нажатии на большинстве элементов */
body {
    -webkit-user-select: none;  /* Safari/Chrome */
    -moz-user-select: none;     /* Firefox */
    -ms-user-select: none;      /* IE/Edge */
    user-select: none;          /* Standard */
}

/* Разрешает выделение и работу с вводом текста */
input, textarea {
    -webkit-user-select: text;
    -moz-user-select: text;
    -ms-user-select: text;
    user-select: text;
}

#top-bar {
    background: #111; padding: 10px; display: flex; gap: 10px; border-bottom: 1px solid #222;
}

button {
    background: #222; color: #eee; padding: 8px 12px; border: none; border-radius: 8px; cursor: pointer;
}
button:hover { background: #333; }

#workspace {
    padding: 15px; flex-grow: 1; overflow-y: auto; display: flex; justify-content: center; scroll-behavior: smooth;
}

#script-area-wrapper {
    width: 100%; max-width: 600px; transform-origin: top center; transition: transform 0.2s ease;
}

#script-area {
    display: flex; flex-direction: column; gap: 12px; width: 100%;
    align-items: flex-end;
}

.block {
    padding: 12px; background: #1e1e22; border-radius: 14px; max-width: 600px;
    position: relative; 
    transition: 0.25s ease, height 0.3s ease, width 0.3s ease; /* Добавлен width transition */
    min-width: 100px; text-align: center; box-sizing: border-box; 
    word-break: break-word; 
    cursor: pointer; 
}

.block.chat {
    border-radius: 18px 18px 4px 18px; 
    background: #242428; 
    padding: 14px;
    max-width: 70%; /* Ограничение для режима просмотра */
    text-align: left; 
}

/* !!! ИСПРАВЛЕННОЕ ПРАВИЛО: Снимаем ограничение max-width только в режиме редактирования !!! */
.block.is-editing-mode.chat {
    max-width: 600px !important; /* Используем полную ширину контейнера, а не 70% */
}

/* !!! ВАЖНОЕ НОВОЕ ПРАВИЛО: Стили для невидимой textarea !!! */
.block-editor-textarea-seamless {
    font-family: inherit; 
    font-size: inherit;   
    color: inherit;
    background: inherit; 
    border: none !important; 
    outline: none !important;
    box-shadow: none !important;
    resize: none !important; 
    display: block; 
    width: 100%; 
    box-sizing: border-box; 
    padding: 0; /* Должен быть 0 */
    margin: 0;
    caret-color: #eee; 
    transition: height 0.3s ease; 
    white-space: pre-wrap; 
    -webkit-tap-highlight-color: transparent; 
    line-height: inherit;
}

/* !!! НОВОЕ ПРАВИЛО: Стили для невидимого input (заголовок) !!! */
.block-editor-input-title-seamless {
    font-family: inherit;
    font-size: inherit;
    font-weight: bold; /* Наследует жирность заголовка */
    color: inherit;
    background: inherit;
    border: none !important;
    outline: none !important;
    box-shadow: none !important;
    display: block;
    width: 100%;
    box-sizing: border-box;
    padding: 0; /* Паддинг 0, т.к. задан родителем */
    margin-bottom: 6px; /* Отступ как у оригинального заголовка */
    -webkit-tap-highlight-color: transparent;
}


#mindmap-screen { position: fixed; inset: 0; background: #0b0b0d; padding: 10px; display: flex; flex-direction: column; }
.hidden { display: none !important; } 
#mindmap-area { margin-top: 10px; position: relative; flex-grow: 1; overflow: auto; background: #0b0b0d; }
#mindmap-content-wrapper { position: absolute; transform-origin: 0 0; width: 5000px; height: 5000px; transition: transform 0.2s ease; }

/* Стили для контекстного меню и кнопок карты */
.map-block-menu { position: absolute; top: -30px; right: 0; }
.map-block-menu button { background: #333; color: #fff; border: none; margin: 2px; padding: 4px 8px; cursor: pointer; border-radius: 4px; }
.map-block-menu button:hover { background: #555; }
#context-menu { position: fixed; background: #1e1e22; border: 1px solid #333; list-style: none; padding: 6px 0; margin: 0; border-radius: 10px; z-index: 9999 !important; width: 170px; opacity: 0; transform: translateY(-4px); transition: opacity 120ms ease, transform 120ms ease; }
#context-menu:not(.hidden) { opacity: 1; transform: translateY(0); }

#context-menu li { list-style: none; padding: 10px 14px; cursor: pointer; user-select: none; }
#context-menu li:active { background: #444; }

.block-content {
  display: inline-block;
  max-width: 100%; /* Должен занимать всю ширину внутри паддинга */
  width: auto;
  white-space: pre-wrap;
}

/* Свернутое сообщение */
.block.collapsed { max-height: 120px; overflow-y: auto; }

.block.collapsed::-webkit-scrollbar { width: 6px; }
.block.collapsed::-webkit-scrollbar-thumb { background-color: rgba(100,100,100,0.6); border-radius: 3px; }
.block.collapsed::-webkit-scrollbar-track { background-color: transparent; }
